script:
##  shortcuts:
##    Notice: The core timezone is UTC
##    CST 20:00-24:00 = time.now().hour > 12 and time.now().hour < 16
##    内核时区为UTC,故以下time.now()函数的取值需要根据本地时区进行转换
##    北京时间(CST) 20:00-24:00 = time.now().hour > 12 and time.now().hour < 16
##    quic: network == 'udp' and dst_port == 443 and (geoip(resolve_ip(host)) != 'CN' or geoip(dst_ip) != 'CN')
##    time-limit: in_cidr(src_ip,'192.168.1.2/32') and time.now().hour < 20 or time.now().hour > 21
##    time-limit: src_ip == '192.168.1.2' and time.now().hour < 20 or time.now().hour > 21

##  code: |
##    def main(ctx, metadata):
##        directkeywordlist = ["baidu"]
##        for directkeyword in directkeywordlist:
##          if directkeyword in metadata["host"]:
##            ctx.log('[Script] matched keyword %s use direct' % directkeyword)
##            return "DIRECT"

rules:
- DOMAIN-SUFFIX,51brstv.com,DIRECT
- DOMAIN-SUFFIX,sysupgrade.org,DIRECT
- DOMAIN-SUFFIX,sysupgradeonline.com,DIRECT
- DOMAIN-SUFFIX,tv-upgrade.com,DIRECT
- DOMAIN-SUFFIX,tvupgrade.org,DIRECT
- DOMAIN-SUFFIX,tvboxsys.com,DIRECT
- DOMAIN-SUFFIX,tvboxsystem.com,DIRECT
- DOMAIN-SUFFIX,fwgcloud.com,DIRECT
- DOMAIN-SUFFIX,aliyuncs.com,DIRECT

## 正式环境IP
##- IP-CIDR,119.28.94.132/32,DIRECT
- IP-CIDR,43.129.96.250/32,DIRECT
- IP-CIDR,43.155.25.63/32,DIRECT
- IP-CIDR,47.88.21.38/32,DIRECT
- IP-CIDR,47.251.39.209/32,DIRECT
- IP-CIDR,47.254.89.146/32,DIRECT
- IP-CIDR,47.254.20.247/32,DIRECT

## 测试环境IP
- IP-CIDR,101.133.132.93/32,DIRECT
- IP-CIDR,101.37.12.115/32,DIRECT
- IP-CIDR,116.62.148.164/32,DIRECT
- IP-CIDR,106.14.174.112/32,DIRECT
- IP-CIDR,47.103.216.18/32,DIRECT

// 流量规则配置